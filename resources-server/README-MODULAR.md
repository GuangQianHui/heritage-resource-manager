# 模块化资源服务器

## 概述

`server-modular.js` 是一个独立的模块化资源服务器启动器，用于启动独立的资源服务器实例。

## 功能特性

- 🚀 **独立启动**: 可以独立启动资源服务器，不依赖主服务器
- ⚙️ **模块化配置**: 支持模块化模式配置
- 🔧 **环境变量**: 支持通过环境变量配置端口和其他参数
- 🛑 **优雅关闭**: 支持优雅关闭服务器进程

## 使用方法

### 直接启动

```bash
cd resources-server
node server-modular.js
```

### 使用环境变量

```bash
PORT=3002 MODULAR_MODE=true node server-modular.js
```

### 在 package.json 中配置

```json
{
  "scripts": {
    "start:modular": "node server-modular.js",
    "start:modular:dev": "PORT=3002 MODULAR_MODE=true node server-modular.js"
  }
}
```

## 配置选项

| 环境变量 | 默认值 | 说明 |
|---------|--------|------|
| `PORT` | `3001` | 服务器端口 |
| `MODULAR_MODE` | `true` | 模块化模式 |

## 启动流程

1. **检查配置**: 验证服务器脚本是否存在
2. **设置环境**: 配置环境变量
3. **启动进程**: 使用 child_process 启动服务器
4. **监听事件**: 处理启动、错误和退出事件
5. **优雅关闭**: 处理 SIGINT 和 SIGTERM 信号

## 错误处理

- 服务器脚本不存在时自动退出
- 启动失败时显示错误信息
- 异常退出时返回相应的退出代码

## 与主服务器的区别

| 特性 | 主服务器 | 模块化服务器 |
|------|----------|-------------|
| 启动方式 | 通过 start-servers.js | 直接启动 |
| 依赖关系 | 依赖主服务器代理 | 独立运行 |
| 配置方式 | 统一配置 | 独立配置 |
| 使用场景 | 开发环境 | 生产环境、独立部署 |

## 注意事项

1. 确保 `server.js` 文件存在
2. 端口不要与其他服务冲突
3. 在生产环境中建议使用 PM2 等进程管理器
