# ğŸš€ ç®€åŒ–éƒ¨ç½²æŒ‡å—ï¼ˆæ— Nginxï¼‰

æœ¬æŒ‡å—å°†å¸®åŠ©æ‚¨å¿«é€Ÿå°†éé—æ–‡åŒ–ä¼ æ‰¿æ™ºèƒ½ä½“åŠ©æ‰‹éƒ¨ç½²åˆ°äº‘æœåŠ¡å™¨ä¸Šï¼Œä¸åŒ…å«Nginxé…ç½®ã€‚

## ğŸ“‹ éƒ¨ç½²å‰å‡†å¤‡

### 1. è´­ä¹°äº‘æœåŠ¡å™¨

**æ¨èé…ç½®ï¼š**
- **CPU**: 2æ ¸
- **å†…å­˜**: 4GB RAM
- **å­˜å‚¨**: 40GB SSD
- **å¸¦å®½**: 5Mbpsä»¥ä¸Š
- **æ“ä½œç³»ç»Ÿ**: Ubuntu 20.04 LTS

**æ¨èå¹³å°ï¼š**
- é˜¿é‡Œäº‘ï¼šhttps://www.aliyun.com/
- è…¾è®¯äº‘ï¼šhttps://cloud.tencent.com/
- åä¸ºäº‘ï¼šhttps://www.huaweicloud.com/

### 2. åŸŸåå‡†å¤‡ï¼ˆå¯é€‰ï¼‰

å¦‚æœæ‚¨æœ‰åŸŸåï¼Œå¯ä»¥é…ç½®åŸŸåè§£æåˆ°æœåŠ¡å™¨IPã€‚

## ğŸ”§ éƒ¨ç½²æ­¥éª¤

### æ­¥éª¤1ï¼šè¿æ¥æœåŠ¡å™¨

ä½¿ç”¨SSHè¿æ¥åˆ°æ‚¨çš„æœåŠ¡å™¨ï¼š

```bash
ssh root@æ‚¨çš„æœåŠ¡å™¨IP
```

### æ­¥éª¤2ï¼šåˆ›å»ºæ™®é€šç”¨æˆ·ï¼ˆå®‰å…¨è€ƒè™‘ï¼‰

```bash
# åˆ›å»ºç”¨æˆ·
adduser heritage
# æ·»åŠ åˆ°sudoç»„
usermod -aG sudo heritage
# åˆ‡æ¢åˆ°æ–°ç”¨æˆ·
su - heritage
```

### æ­¥éª¤3ï¼šä¸‹è½½å¹¶è¿è¡Œç®€åŒ–éƒ¨ç½²è„šæœ¬

```bash
# ä¸‹è½½ç®€åŒ–éƒ¨ç½²è„šæœ¬
wget https://raw.githubusercontent.com/GuangQianHui/heritage-resource-manager/main/deploy-simple.sh

# ç»™è„šæœ¬æ‰§è¡Œæƒé™
chmod +x deploy-simple.sh

# è¿è¡Œéƒ¨ç½²è„šæœ¬
./deploy-simple.sh
```

## ğŸŒ è®¿é—®åº”ç”¨

éƒ¨ç½²å®Œæˆåï¼Œæ‚¨å¯ä»¥é€šè¿‡ä»¥ä¸‹æ–¹å¼è®¿é—®ï¼š

- **ä¸»åº”ç”¨**: http://æ‚¨çš„æœåŠ¡å™¨IP:3000
- **èµ„æºæœåŠ¡å™¨**: http://æ‚¨çš„æœåŠ¡å™¨IP:3001
- **åŸŸåè®¿é—®**: http://æ‚¨çš„åŸŸå:3000ï¼ˆéœ€è¦é…ç½®åŸŸåè§£æï¼‰

## ğŸ”§ ç®¡ç†å‘½ä»¤

### æŸ¥çœ‹åº”ç”¨çŠ¶æ€
```bash
pm2 status
```

### æŸ¥çœ‹æ—¥å¿—
```bash
pm2 logs
```

### é‡å¯åº”ç”¨
```bash
pm2 restart all
```

### æ›´æ–°åº”ç”¨
```bash
./update.sh
```

### ç›‘æ§ç³»ç»Ÿ
```bash
./monitor.sh
```

## ğŸ“Š æ€§èƒ½ä¼˜åŒ–

### 1. ç›‘æ§èµ„æºä½¿ç”¨
```bash
# æŸ¥çœ‹ç³»ç»Ÿèµ„æº
htop
# æŸ¥çœ‹ç£ç›˜ä½¿ç”¨
df -h
# æŸ¥çœ‹å†…å­˜ä½¿ç”¨
free -h
```

### 2. åº”ç”¨æ€§èƒ½ç›‘æ§
```bash
# æŸ¥çœ‹PM2ç›‘æ§
pm2 monit
```

## ğŸ”’ å®‰å…¨å»ºè®®

### 1. é˜²ç«å¢™é…ç½®
éƒ¨ç½²è„šæœ¬å·²è‡ªåŠ¨é…ç½®UFWé˜²ç«å¢™ï¼Œå¼€æ”¾äº†å¿…è¦çš„ç«¯å£ã€‚

### 2. å®šæœŸæ›´æ–°
```bash
# æ›´æ–°ç³»ç»Ÿ
sudo apt update && sudo apt upgrade -y

# æ›´æ–°åº”ç”¨
./update.sh
```

### 3. å¤‡ä»½æ•°æ®
```bash
# åˆ›å»ºå¤‡ä»½
tar -czf backup-$(date +%Y%m%d).tar.gz /opt/heritage-app
```

## ğŸš¨ æ•…éšœæ’é™¤

### 1. åº”ç”¨æ— æ³•å¯åŠ¨
```bash
# æŸ¥çœ‹é”™è¯¯æ—¥å¿—
pm2 logs heritage-main-server --err
pm2 logs heritage-resource-server --err
```

### 2. ç«¯å£è¢«å ç”¨
```bash
# æŸ¥çœ‹ç«¯å£å ç”¨
sudo netstat -tulpn | grep :3000
sudo netstat -tulpn | grep :3001
```

### 3. å†…å­˜ä¸è¶³
```bash
# æŸ¥çœ‹å†…å­˜ä½¿ç”¨
free -h
# å¢åŠ swapç©ºé—´
sudo fallocate -l 2G /swapfile
sudo chmod 600 /swapfile
sudo mkswap /swapfile
sudo swapon /swapfile
```

## ğŸ”„ åç»­ä¼˜åŒ–ï¼ˆå¯é€‰ï¼‰

### 1. é…ç½®åŸŸåè®¿é—®

å¦‚æœæ‚¨æœ‰åŸŸåï¼Œå¯ä»¥é…ç½®åŸŸåè§£æï¼š

1. åœ¨åŸŸåæä¾›å•†å¤„æ·»åŠ Aè®°å½•ï¼ŒæŒ‡å‘æ‚¨çš„æœåŠ¡å™¨IP
2. ç­‰å¾…DNSè§£æç”Ÿæ•ˆï¼ˆé€šå¸¸å‡ åˆ†é’Ÿåˆ°å‡ å°æ—¶ï¼‰

### 2. é…ç½®SSLè¯ä¹¦ï¼ˆæ¨èï¼‰

å¦‚æœéœ€è¦HTTPSè®¿é—®ï¼Œå»ºè®®é…ç½®SSLè¯ä¹¦ï¼š

```bash
# å®‰è£…certbot
sudo apt install certbot

# è·å–SSLè¯ä¹¦ï¼ˆéœ€è¦åŸŸåï¼‰
sudo certbot certonly --standalone -d your-domain.com

# é…ç½®åº”ç”¨ä½¿ç”¨SSLï¼ˆéœ€è¦ä¿®æ”¹åº”ç”¨ä»£ç ï¼‰
```

### 3. é…ç½®Nginxåå‘ä»£ç†ï¼ˆå¯é€‰ï¼‰

å¦‚æœåç»­éœ€è¦æ›´é«˜çº§çš„åŠŸèƒ½ï¼Œå¯ä»¥æ·»åŠ Nginxï¼š

```bash
# å®‰è£…Nginx
sudo apt install nginx

# é…ç½®åå‘ä»£ç†
sudo nano /etc/nginx/sites-available/heritage-app
```

## ğŸ“ è·å–å¸®åŠ©

å¦‚æœé‡åˆ°é—®é¢˜ï¼Œå¯ä»¥ï¼š

1. æŸ¥çœ‹é¡¹ç›®æ–‡æ¡£ï¼šhttps://github.com/GuangQianHui/heritage-resource-manager
2. æäº¤Issueï¼šhttps://github.com/GuangQianHui/heritage-resource-manager/issues
3. æŸ¥çœ‹éƒ¨ç½²æ—¥å¿—ï¼š`pm2 logs`

## ğŸ‰ éƒ¨ç½²å®Œæˆ

æ­å–œï¼æ‚¨çš„éé—æ–‡åŒ–ä¼ æ‰¿æ™ºèƒ½ä½“åŠ©æ‰‹å·²ç»æˆåŠŸéƒ¨ç½²åˆ°æœåŠ¡å™¨ä¸Šï¼Œç°åœ¨å¯ä»¥é€šè¿‡å…¬ç½‘è®¿é—®äº†ï¼

### è®¿é—®åœ°å€
- **ä¸»åº”ç”¨**: http://æ‚¨çš„æœåŠ¡å™¨IP:3000
- **èµ„æºæœåŠ¡å™¨**: http://æ‚¨çš„æœåŠ¡å™¨IP:3001

---

**æ³¨æ„**: è¯·ç¡®ä¿å®šæœŸå¤‡ä»½æ•°æ®å¹¶ä¿æŒç³»ç»Ÿæ›´æ–°ã€‚
